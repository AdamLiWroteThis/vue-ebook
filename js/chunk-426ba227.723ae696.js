(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-426ba227"],{"2ca0":function(t,e,a){"use strict";var i=a("23e7"),o=a("06cf").f,n=a("50c4"),s=a("5a34"),r=a("1d80"),c=a("ab13"),l=a("c430"),d="".startsWith,u=Math.min,h=c("startsWith"),f=!l&&!h&&!!function(){var t=o(String.prototype,"startsWith");return t&&!t.writable}();i({target:"String",proto:!0,forced:!f&&!h},{startsWith:function(t){var e=String(r(this));s(t);var a=n(u(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return d?d.call(e,i,a):e.slice(a,a+i.length)===i}})},"44e7":function(t,e,a){var i=a("861d"),o=a("c6b6"),n=a("b622"),s=n("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[s])?!!e:"RegExp"==o(t))}},"4d63":function(t,e,a){var i=a("83ab"),o=a("da84"),n=a("94ca"),s=a("7156"),r=a("9bf2").f,c=a("241c").f,l=a("44e7"),d=a("ad6d"),u=a("9f7f"),h=a("6eeb"),f=a("d039"),p=a("69f3").set,v=a("2626"),b=a("b622"),g=b("match"),m=o.RegExp,k=m.prototype,w=/a/g,y=/a/g,_=new m(w)!==w,C=u.UNSUPPORTED_Y,x=i&&n("RegExp",!_||C||f((function(){return y[g]=!1,m(w)!=w||m(y)==y||"/a/i"!=m(w,"i")})));if(x){var $=function(t,e){var a,i=this instanceof $,o=l(t),n=void 0===e;if(!i&&o&&t.constructor===$&&n)return t;_?o&&!n&&(t=t.source):t instanceof $&&(n&&(e=d.call(t)),t=t.source),C&&(a=!!e&&e.indexOf("y")>-1,a&&(e=e.replace(/y/g,"")));var r=s(_?new m(t,e):m(t,e),i?this:k,$);return C&&a&&p(r,{sticky:a}),r},S=function(t){t in $||r($,t,{configurable:!0,get:function(){return m[t]},set:function(e){m[t]=e}})},N=c(m),T=0;while(N.length>T)S(N[T++]);k.constructor=$,$.prototype=k,h(o,"RegExp",$)}v("RegExp")},"5a34":function(t,e,a){var i=a("44e7");t.exports=function(t){if(i(t))throw TypeError("The method doesn't accept regular expressions");return t}},"5bab":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"book-detail"},[a("detail-title",{ref:"title",attrs:{showShelf:!0},on:{back:t.back}}),a("scroll",{ref:"scroll",staticClass:"content-wrapper",attrs:{top:42,bottom:52},on:{onScroll:t.onScroll}},[a("book-info",{attrs:{cover:t.cover,title:t.title,author:t.author,desc:t.desc}}),a("div",{staticClass:"book-detail-content-wrapper"},[a("div",{staticClass:"book-detail-content-title"},[t._v(" "+t._s(t.$t("detail.copyright"))+" ")]),a("div",{staticClass:"book-detail-content-list-wrapper"},[a("div",{staticClass:"book-detail-content-row"},[a("div",{staticClass:"book-detail-content-label"},[t._v(" "+t._s(t.$t("detail.publisher"))+" ")]),a("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.publisher))])]),a("div",{staticClass:"book-detail-content-row"},[a("div",{staticClass:"book-detail-content-label"},[t._v(" "+t._s(t.$t("detail.category"))+" ")]),a("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.categoryText))])]),a("div",{staticClass:"book-detail-content-row"},[a("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.lang")))]),a("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.lang))])]),a("div",{staticClass:"book-detail-content-row"},[a("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.ISBN")))]),a("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.isbn))])])])]),a("div",{staticClass:"book-detail-content-wrapper"},[a("div",{staticClass:"book-detail-content-title"},[t._v(" "+t._s(t.$t("detail.navigation"))+" ")]),a("div",{staticClass:"book-detail-content-list-wrapper"},[this.navigation?t._e():a("div",{staticClass:"loading-text-wrapper"},[a("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])]),a("div",{staticClass:"book-detail-content-item-wrapper"},t._l(t.flatNavigation,(function(e,i){return a("div",{key:i,staticClass:"book-detail-content-item",on:{click:function(a){return t.read(e)}}},[e.label?a("div",{staticClass:"book-detail-content-navigation-text",class:{"is-sub":e.deep>1},style:t.itemStyle(e)},[t._v(" "+t._s(e.label)+" ")]):t._e()])})),0)])]),a("div",{staticClass:"book-detail-content-wrapper"},[a("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.trial")))]),a("div",{staticClass:"book-detail-content-list-wrapper"},[this.displayed?t._e():a("div",{staticClass:"loading-text-wrapper"},[a("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:this.displayed,expression:"this.displayed"}],ref:"preview",attrs:{id:"preview"}})])],1),a("div",{staticClass:"bottom-wrapper"},[a("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.readBook()}}},[t._v(" "+t._s(t.$t("detail.read"))+" ")]),a("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.trialListening()}}},[t._v(" "+t._s(t.$t("detail.listen"))+" ")]),a("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addOrRemoveShelf()}}},[t.inBookShelf?a("span",{staticClass:"icon-check"}):t._e(),t._v(" "+t._s(t.inBookShelf?t.$t("detail.isAddedToShelf"):t.$t("detail.addOrRemoveShelf"))+" ")])]),a("toast",{ref:"toast",attrs:{text:t.toastText}})],1)},o=[],n=a("70e8"),s=n["a"],r=(a("8d99"),a("2877")),c=Object(r["a"])(s,i,o,!1,null,"7c995083",null);e["default"]=c.exports},"70e8":function(t,e,a){"use strict";(function(t){a("a4d3"),a("e01a"),a("99af"),a("4de4"),a("4160"),a("d81d"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("2ca0"),a("159b");var i=a("2909"),o=a("1432"),n=a("c470"),s=a("6701"),r=a("78dc"),c=a("73f5"),l=a("fa7d"),d=a("a211"),u=a("101f");t.ePub=d["a"],e["a"]={components:{DetailTitle:o["a"],Scroll:s["a"],BookInfo:n["a"],Toast:r["a"]},computed:{desc:function(){return this.description?this.description.substring(0,100):""},flatNavigation:function(){return this.navigation?Array.prototype.concat.apply([],Array.prototype.concat.apply([],this.doFlatNavigation(this.navigation.toc))):[]},lang:function(){return this.metadata?this.metadata.language:"-"},isbn:function(){return this.metadata?this.metadata.identifier:"-"},publisher:function(){return this.metadata?this.metadata.publisher:"-"},title:function(){return this.metadata?this.metadata.title:""},author:function(){return this.metadata?this.metadata.creator:""},inBookShelf:function(){var t=this;if(this.bookItem&&this.bookShelf){var e=function t(e){var a;return(a=[]).concat.apply(a,Object(i["a"])(e.map((function(e){return e.itemList?[e].concat(Object(i["a"])(t(e.itemList))):e}))))}(this.bookShelf).filter((function(t){return 1===t.type})),a=e.filter((function(e){return e.fileName===t.bookItem.fileName}));return a&&a.length>0}return!1}},data:function(){return{bookItem:null,book:null,metadata:null,trialRead:null,cover:null,navigation:null,displayed:!1,audio:null,randomLocation:null,description:null,toastText:"",trialText:null,categoryText:null,opf:null}},methods:{addOrRemoveShelf:function(){},showToast:function(t){this.toastText=t,this.$refs.toast.show()},readBook:function(){this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},trialListening:function(){var t=this;Object(u["b"])(this.bookItem.fileName,(function(e,a){!e&&a&&a instanceof Blob?t.$router.push({path:"/store/speaking",query:{fileName:t.bookItem.fileName}}):t.$router.push({path:"/store/speaking",query:{fileName:t.bookItem.fileName,opf:t.opf}})}))},read:function(t){this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},itemStyle:function(t){return{marginLeft:(t.deep-1)*Object(l["a"])(20)+"rem"}},doFlatNavigation:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=[];return t.forEach((function(t){t.deep=a,i.push(t),t.subitems&&t.subitems.length>0&&i.push(e.doFlatNavigation(t.subitems,a+1))})),i},downloadBook:function(){var t="".concat("https://junliwrotethis.github.io/vue-ebook/epub","/").concat(this.bookItem.categoryText,"/").concat(this.bookItem.fileName,"/OEBPS/package.opf");this.parseBook(t)},parseBook:function(t){var e=this;this.book=new d["a"](t),this.book.loaded.metadata.then((function(t){e.metadata=t})),this.book.loaded.navigation.then((function(t){if(console.log(t),e.navigation=t,e.navigation.toc&&e.navigation.toc.length>1){var a=e.display(e.navigation.toc[1].href);a&&a.then((function(t){e.$refs.scroll&&e.$refs.scroll.refresh(),e.displayed=!0;var a=new RegExp("<.+?>","g"),i=t.output.replace(a,"").replace(/\s\s/g,"");e.description=i}))}}))},init:function(){var t=this;this.fileName=this.$route.query.fileName,this.categoryText=this.$route.query.category,this.fileName&&Object(c["a"])({fileName:this.fileName}).then((function(e){if(200===e.status&&0===e.data.error_code&&e.data.data){var a=e.data.data;console.log(a),t.bookItem=a,t.cover=t.bookItem.cover;var i=a.rootFile;i.startsWith("/")&&(i=i.substring(1,i.length)),t.opf="".concat("https://junliwrotethis.github.io/vue-ebook","/epub/ComputerScience/").concat(t.fileName,"/").concat(i),console.log(t.opf),t.parseBook(t.opf)}else t.showToast(e.data.msg)}))},back:function(){this.$router.go(-1)},display:function(t){if(this.$refs.preview)return this.rendition||(this.rendition=this.book.renderTo("preview",{width:window.innerWidth>640?640:window.innerWidth,height:window.innerHeight,method:"default"})),t?this.rendition.display(t):this.rendition.display()},onScroll:function(t){t>Object(l["b"])(42)?this.$refs.title.showShadow():this.$refs.title.hideShadow()}},mounted:function(){this.init()}}}).call(this,a("c8ba"))},"79a6":function(t,e,a){},"8d99":function(t,e,a){"use strict";var i=a("79a6"),o=a.n(i);o.a},ab13:function(t,e,a){var i=a("b622"),o=i("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[o]=!1,"/./"[t](e)}catch(i){}}return!1}}}]);
//# sourceMappingURL=chunk-426ba227.723ae696.js.map